<!DOCTYPE html>

<html>
<head>
  <title>widget.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>widget.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>Widget = {
  VERSION: <span class="string">"0.0.2"</span>,
  DESCRIPTION: <span class="string">""</span>,
  DEBUG: <span class="literal">true</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <h2>Component.baseOptions</h2>
<p>Libraries needs to correct run</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  baseOptions: {
    <span class="string">'$'</span>: <span class="string">'/libs/jquery-1.8.3.js'</span>,
    <span class="string">'_'</span>: <span class="string">'/libs/underscore.js'</span>,
    <span class="string">'Backbone'</span>: <span class="string">'/libs/backbone.js'</span>,
    <span class="string">'Layout'</span>: <span class="string">'/libs/backbone.layoutmanager.js'</span>,
    <span class="string">'Handlebars'</span>: <span class="string">'/libs/handlebars-1.0.rc.1.js'</span> 
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <h2>Component.log</h2>
<p>Wrapper for console.log.
Works when Loader.DEBUG is true</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="comment">/**
   * Wrapper for console.log.
   * Parameters:
   *   @message [String] - text message
   */</span>   
  log: <span class="keyword">function</span>( message ){
    <span class="keyword">if</span>( Widget.DEBUG )
      console.log( message );
  },

  proto: {
    name: <span class="string">"widgetname"</span>,
		include: {
      js:{},
			css:{},
			template:{}
		},
		view: {},
		model: {},
		template: {},
    templateData: {},</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>initializing</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		init: <span class="keyword">function</span>( callback ){
      <span class="keyword">if</span>( callback &amp;&amp; (<span class="keyword">typeof</span> callback !== <span class="string">'undefined'</span>) )
        <span class="keyword">this</span>.callback = callback;
      <span class="keyword">else</span>
        <span class="keyword">this</span>.callback = <span class="literal">null</span>;
      <span class="keyword">var</span> that = <span class="keyword">this</span>;

      that.loadRequires( 
        <span class="keyword">function</span>( component ){
          component.setModel();
          component.setView();
          component.render();
          <span class="keyword">if</span>( component.callback &amp;&amp; (<span class="keyword">typeof</span> component.callback !== <span class="string">'undefined'</span>) ){
            component.callback();
          }
        }.bind( <span class="literal">null</span>, that ) 
      );
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>loading libs and files needs to widget</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		loadRequires: <span class="keyword">function</span>( callback ){
      <span class="keyword">var</span> r = <span class="keyword">this</span>.include;
      <span class="keyword">var</span> aList = [];
      <span class="keyword">var</span> aJSList  = _.values( r.js );
      <span class="keyword">var</span> aCSSList = _.map( _.values( r.css ), <span class="keyword">function</span>(item){ <span class="keyword">return</span> <span class="string">'css!'</span>+item; } );
      <span class="keyword">var</span> aHBSList = _.values( r.template ); 
      aList = aJSList.concat( aCSSList, aHBSList );
      Loader.Manager( aList, callback );
		},
		setView: <span class="keyword">function</span>(){
      <span class="keyword">this</span>.options = <span class="keyword">this</span>.view;
    
      <span class="keyword">if</span>( <span class="keyword">this</span>.include.template ){
        <span class="keyword">var</span> template = Handlebars.compile( 
          $(<span class="string">"script[data-template-name="</span>+ _.keys(<span class="keyword">this</span>.include.template)[<span class="number">0</span>] +<span class="string">"]"</span>).html()
        );
        template = template( _.extend({},<span class="keyword">this</span>.view.templateData) ) ;
        _.extend( 
            <span class="keyword">this</span>.view, 
            {
              model: <span class="keyword">this</span>.model,</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>template: this.template ( this.templateData ) 
template: Handlebars.compile( this.view.$el.find(&quot;script[data-template-name=menu]&quot;).html() )</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>              template: template 
            } 
        );
      }
      <span class="keyword">else</span>{
        _.extend( <span class="keyword">this</span>.view, {model: <span class="keyword">this</span>.model, template: <span class="keyword">this</span>.template } );
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>_.extend( this.view, {model: this.model, /<em>template: this.template</em>/ } );</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">this</span>.view = Backbone.Layout.extend( <span class="keyword">this</span>.view );
		},
		setModel: <span class="keyword">function</span>(){
      <span class="keyword">this</span>.model = Backbone.Model.extend( <span class="keyword">this</span>.model );
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>render view</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		render: <span class="keyword">function</span>(){
      <span class="keyword">this</span>.view = <span class="keyword">new</span> <span class="keyword">this</span>.view();
      <span class="keyword">this</span>.view.render();</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>this.view.render();</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">return</span> <span class="keyword">this</span>;
		}
	},

  create: <span class="keyword">function</span>( options, html_el, callback ){
    <span class="keyword">var</span> obj  = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>reinitialize options</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    options = options || {};</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>add standart data</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _.extend( obj, Widget.proto, options );</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">if</span>( html_el ){
      obj.view.el = html_el;
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>init object</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    obj.init( callback );</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>return object</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">return</span> obj;
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <h2>Widget.environment</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="comment">/**
   * initialize and load nessesary libs
   * Parameters:
   *   @callback [function] - run when initialization has been finished
   *   @error [function] - run when raise error
   */</span>  
  environment: <span class="keyword">function</span>( options, callback, error ){</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Check for Loader</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">if</span>( window[<span class="string">"Loader"</span>] ){</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>when no data in options then
change options on Component.baseOptions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">if</span>( <span class="keyword">typeof</span> options === <span class="string">'undefined'</span> ){
        options = Widget.baseOptions;
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Other way, create new object from options 
and Component.baseOptions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">else</span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Simple extend of two object
But needs before underscore.js</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        Object.extend = <span class="keyword">function</span>(destination,source) {
          <span class="keyword">for</span> (<span class="keyword">var</span> property <span class="keyword">in</span> source)
            destination[property] = source[property];
          <span class="keyword">return</span> destination;
        };

        options = Object.extend( <span class="comment">/*options,*/</span> Widget.baseOptions, options );
      };</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Array</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">var</span> aFiles = [];</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>Prepare array of libraries url</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">for</span>( <span class="keyword">var</span> property <span class="keyword">in</span> options ){</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Fill array aFiles</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        aFiles.push( options[property] );
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>Loading nessessary libs when array is not empty</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">if</span>( aFiles.length &gt; <span class="number">0</span> ){
        Loader.Manager( aFiles, callback, error );
      }
    }
    <span class="keyword">else</span>{
      Widget.log( <span class="string">"loader.js is nessesary"</span> );
    }
  }

};</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
